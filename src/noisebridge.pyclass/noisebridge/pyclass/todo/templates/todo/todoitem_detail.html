{% extends "base.html" %}
{% load comments %}

{% block content %}
    <h1>{{ todoitem.name }}</h1>
    <p>{{ todoitem.details }}</p>
    <p>Excellence: {{ todoitem.excellence }}</p>
    <p>Due: {{todoitem.due }}</p>
    <p>Importance: {{ todoitem.importance }}</p>
    <p>Status: {{ todoitem.status }}</p>
    {% if todoitem.status == 'C' %}
		<p>Completed by: {{ todoitem.completed_by }}</p>
		<p>Completed on: {{ todoitem.completion_date }}</p>
    {% endif %}

    <h2>Interests</h2>
	<ul>
	{% for interest in todoitem.interests.all %}
		<li><a href={{ "interest.get_absolute_url" }}>{{ interest.name }}</a></li>
	{% endfor %}
	</ul>

    <h2>Tags</h2>
	<ul>
	{% for tag in todoitem.tags.all %}
		<li><a href={{ "tag.get_absolute_url" }}>{{ tag.name }}</a></li>
	{% endfor %}
	</ul>

    {% with claims=todoitem.users_claimed.all %}
        <h2>Claims</h2>
        <ul>
        {% for user in claims %}
            <li><a href={{ "user.get_absolute_url" }}>{{ user.username }}</a></li>
        {% endfor %}
        </ul>

        {% if todoitem.status != 'C' %}
            {% if not user in claims %}
                <a href="{% url claim_todo todoitem.pk %}">Claim Task</a>
            {% endif %}
            <a href="{% url complete_todo todoitem.pk %}">Complete Task</a>
        {% endif %}
    {% endwith %}

    {% get_comment_count for todoitem as comment_count %}
    <hr>
    <p>This item has {{ comment_count }} comment{{ comment_count|pluralize }}.</p>
    {% render_comment_list for todoitem %}
    <hr>
    <p>Add a comment</p>
    {% render_comment_form for todoitem %}
{% endblock content %}
